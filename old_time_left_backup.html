<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Left</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            text-align: center;
        }
        input {
            padding: 10px;
            margin: 10px;
            font-size: 1em;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
            font-size: 1.2em;
        }
        #currentTime {
            font-size: 1.1em;
            color: #555;
        }
    </style>
</head>
<body>
    <h1>Time Left Before Going Home</h1>
    <label for="startTimeInput">Enter Work Start Time (HH:MM):</label>
    <input type="time" id="startTimeInput" onchange="updateStartTime()">
    <div id="currentTime"></div>
    <div id="result"></div>

    <script>
        let startTime = null; // Store start time globally

        function updateStartTime() {
            const startTimeInput = document.getElementById('startTimeInput').value;
            if (startTimeInput) {
                const [hours, minutes] = startTimeInput.split(':').map(Number);
                startTime = new Date();
                startTime.setHours(hours, minutes, 0, 0);
            } else {
                startTime = null;
            }
            updateTimeLeft(); // Update immediately after input
        }

        function updateTimeLeft() {
            const resultDiv = document.getElementById('result');
            const currentTimeDiv = document.getElementById('currentTime');

            // Get current time
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const currentTimeStr = `${hours}:${minutes}:${seconds}`;

            // Display current time
            currentTimeDiv.textContent = `Current Time: ${currentTimeStr}`;

            // Check if start time is set
            if (!startTime) {
                resultDiv.textContent = 'Please enter a work start time.';
                document.title = 'Time Left';
                return;
            }

            // Get current day
            const isSaturday = now.getDay() === 6;

            // Hours to stay: 8 for Saturday, 3 for other days
            const hoursToStay = isSaturday ? 8 : 3;

            // Calculate leaving time
            const leaveTime = new Date(startTime.getTime() + hoursToStay * 60 * 60 * 1000);

            // Calculate time left
            const timeDiff = leaveTime - now;
            const hoursLeft = Math.floor(timeDiff / (1000 * 60 * 60));
            const minutesLeft = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
            const secondsLeft = Math.floor((timeDiff % (1000 * 60)) / 1000);

            // Format leaving time for display
            const leaveHours = leaveTime.getHours().toString().padStart(2, '0');
            const leaveMinutes = leaveTime.getMinutes().toString().padStart(2, '0');
            const leaveSeconds = leaveTime.getSeconds().toString().padStart(2, '0');
            const formattedLeaveTime = `${leaveHours}:${leaveMinutes}:${leaveSeconds}`;

            // Format time left for tab title
            let tabTitle;
            if (timeDiff > 0) {
                tabTitle = `${hoursLeft}h ${minutesLeft}m ${secondsLeft}s`;
            } else {
                tabTitle = `Time to Go Home!`;
            }

            // Update browser tab title
            document.title = tabTitle;

            // Display result
            if (timeDiff > 0) {
                resultDiv.textContent = `You can go home at ${formattedLeaveTime}. Time left: ${hoursLeft} hours, ${minutesLeft} minutes, and ${secondsLeft} seconds.`;
            } else {
                resultDiv.textContent = `Your work time is over! You can go home now.`;
            }
        }

        // Initial call
        updateTimeLeft();

        // Auto-refresh every second
        setInterval(updateTimeLeft, 1000);
    </script>
</body>
</html>